<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.73">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="authorizer Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="authorizer Blog Atom Feed"><title data-react-helmet="true">Architecture | authorizer</title><meta data-react-helmet="true" property="og:url" content="https://authorizer-tech.github.io/docs/overview/architecture"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Architecture | authorizer"><meta data-react-helmet="true" name="description" content="The authorizer platform is composed of three primary systems:"><meta data-react-helmet="true" property="og:description" content="The authorizer platform is composed of three primary systems:"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://authorizer-tech.github.io/docs/overview/architecture"><link data-react-helmet="true" rel="alternate" href="https://authorizer-tech.github.io/docs/overview/architecture" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://authorizer-tech.github.io/docs/overview/architecture" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.e6c3d5bb.css">
<link rel="preload" href="/assets/js/styles.a2d76c0d.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.32f1b2c3.js" as="script">
<link rel="preload" href="/assets/js/main.02195362.js" as="script">
<link rel="preload" href="/assets/js/1.25a68bf1.js" as="script">
<link rel="preload" href="/assets/js/2.01a26798.js" as="script">
<link rel="preload" href="/assets/js/3.cd72b133.js" as="script">
<link rel="preload" href="/assets/js/1be78505.b26effb6.js" as="script">
<link rel="preload" href="/assets/js/50.527acb5e.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.1719123e.js" as="script">
<link rel="preload" href="/assets/js/17896441.ee62131d.js" as="script">
<link rel="preload" href="/assets/js/d72ac48e.7a0f177a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/authorizer.png" alt="site-logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/authorizer.png" alt="site-logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">authorizer.tech</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/overview/introduction">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/overview/introduction">Next</a><a href="https://github.com/authorizer-tech" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">üåô</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/authorizer.png" alt="site-logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/authorizer.png" alt="site-logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">authorizer.tech</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/overview/introduction">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link">Versions</a></li><li class="menu__list-item"><a href="https://github.com/authorizer-tech" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">üóíÔ∏è Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/introduction">Introduction</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/overview/architecture">Architecture</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/concepts/concepts-intro">Concepts - Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/concepts/relation-tuples">Relation Tuples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/concepts/namespaces">Namespaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/concepts/objects">Objects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/concepts/subjects">Subjects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/concepts/graph-of-relations">Graph of Relations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/concepts/snaptokens">Snaptokens</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/examples/examples-intro">Examples - Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/examples/abac">ABAC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/examples/acl">ACL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/examples/advanced-rewrites">Advanced Rewrites</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/examples/hierarchy">Hierarchical Permissions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview/examples/rbac">RBAC</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">üöÄ Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/getting-started-intro">Getting Started - Intro</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Setup a Cluster</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/install/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/install/docker">Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/install/binary">Pre-built Binaries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/install/kubernetes">Kubernetes</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/configuration">‚öôÔ∏è  Configuration</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">üìö API Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-reference/overview">API Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-reference/check-service">CheckService</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-reference/expand-service">ExpandService</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-reference/nsconfig-service">NamespaceConfigService</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-reference/read-service">ReadService</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-reference/watch-service">WatchService</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-reference/write-service">WriteService</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/performance">üìà Performance</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development">üñ•Ô∏è Development</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/faq">üí° FAQ</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Architecture</h1></header><div class="markdown"><p>The authorizer platform is composed of three primary systems:</p><ul><li><p><a href="https://github.com/authorizer-tech/access-controller" target="_blank" rel="noopener noreferrer"><strong>access-controller</strong></a> - An access-controller serves RPCs for Check, Expand, Read, Write, and RPCs to administer namespace configs.</p></li><li><p><a href="https://github.com/authorizer-tech/access-watcher" target="_blank" rel="noopener noreferrer"><strong>access-watcher</strong></a> - An access-watcher serves Watch RPCs and streams changes from a changelog in near real-time to clients interested in changes to one or more namespaces.</p></li><li><p><a href="https://github.com/authorizer-tech/access-indexer" target="_blank" rel="noopener noreferrer"><strong>access-indexer</strong></a> - An indexing system used to optimize operations on large and deeply nested sets. It reads periodic snapshots of ACL data and watches for changes between snapshots. It performs transformations on that data, such as denormalization, and responds to requests from access-controllers.</p></li></ul><p align="center"><img src="/img/architecture.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="namespace-configuration-storage"></a>Namespace Configuration Storage<a class="hash-link" href="#namespace-configuration-storage" title="Direct link to heading">#</a></h2><p><a href="/docs/overview/concepts/namespaces">Namespace Configurations</a> are persisted across two database tables. One table contains the configs and is indexed by namespace. The other is a namespace config changelog that stores config updates and is indexed by commit timestamp. This structure allows the access-controller servers to initially load configs on startup and also continuously monitor namespace config changes at runtime.</p><p>Changes to namespace configs can affect the outcome of authorization evaluations, and therefore their correctness. Thefore, each access-controller chooses a single snapshot timestamp for namespace config metadata when evaluating a client request. All access-controllers in a cluster use the same timestamp for the same request, including any subrequests that fan out from the original client request.</p><p>Each access-controller independently loads namespace configs from storage continuously as they change. An access-controller in a cluster may have access to a different range of namespace config timestamps due to restarts or network latency, and thus an access-controller must pick a timestamp that is available across the quorum of members in the cluster. To facilitate this, each access-controller implements a background monitoring job that tracks the timestamp range available to every cluster member and aggregates them. On each incoming request an access-controller picks a time from this range, ensuring that all requests can continue to be served even if they are no longer able to read from the config storage.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="relation-tuple-storage"></a>Relation Tuple Storage<a class="hash-link" href="#relation-tuple-storage" title="Direct link to heading">#</a></h2><p><a href="/docs/overview/concepts/relation-tuples">Relation tuples</a> are persisted across separate namespace tables. A relation tuple is identified by a primary key of the form <code>(object, relation, subject, timestamp)</code>. Multiple tuple versions are stored on different rows, thus allowing authorization checks to be evaluated within a certain time window.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="changelog"></a>Changelog<a class="hash-link" href="#changelog" title="Direct link to heading">#</a></h2><p>The authorizer platform maintains a changelog that stores a history of changes to relation tuples. For every mutation that is commited to relation tuple storage, an additional mutation is applied within the same transaction to the changelog. The changelog allows the access-watcher to serve Watch requests. The <a href="/docs/api-reference/watch-service">WatchService API</a> allows clients to continuously monitor changes to relation tuples in one or more namespaces and maintain secondary indices of the relation tuples. This can help clients create authorization-aware search indices for web frontends or other use cases.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/authorizer-tech/authorizer-web/edit/master/docs/docs/overview/architecture.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/overview/introduction"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Introduction</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/overview/concepts/concepts-intro"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Concepts - Intro ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#namespace-configuration-storage" class="table-of-contents__link">Namespace Configuration Storage</a></li><li><a href="#relation-tuple-storage" class="table-of-contents__link">Relation Tuple Storage</a></li><li><a href="#changelog" class="table-of-contents__link">Changelog</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/overview/introduction">Documentation</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://authorizer-tech.slack.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/authorizer-tech" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021</div></div></div></footer></div>
<script src="/assets/js/styles.a2d76c0d.js"></script>
<script src="/assets/js/runtime~main.32f1b2c3.js"></script>
<script src="/assets/js/main.02195362.js"></script>
<script src="/assets/js/1.25a68bf1.js"></script>
<script src="/assets/js/2.01a26798.js"></script>
<script src="/assets/js/3.cd72b133.js"></script>
<script src="/assets/js/1be78505.b26effb6.js"></script>
<script src="/assets/js/50.527acb5e.js"></script>
<script src="/assets/js/935f2afb.1719123e.js"></script>
<script src="/assets/js/17896441.ee62131d.js"></script>
<script src="/assets/js/d72ac48e.7a0f177a.js"></script>
</body>
</html>